Vagrant.configure("2") do |config|
    config.vm.box = "gusztavvargadr/docker-linux"
    config.vm.provision "shell", inline: <<-SHELL
    # Update package lists and install git, python3, pip, netcat and docker
    apt-get update
    apt-get install -y git python netcat
     
    # add new user
    useradd -m -s /bin/bash -p $(openssl passwd -1 "password") user
    
    # use the new user
    su - user

    # Clone the repository
    git clone https://github.com/iliass-dahman/CVE-2022-22963-POC
      
    # Navigate to the cloned repository
    cd CVE-2022-22963-POC
      
    # Build the Dockerfile
    docker build -t cve_2022_22963:latest .
      
    # Run the Docker container
    docker run --network host --name vulnerable_server -d cve_2022_22963:latest
    SHELL
  end
  